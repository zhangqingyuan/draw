{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from 'react';\nexport const useAudioControl = (bgMusic, rollMusic, winMusic) => {\n  _s();\n  const [isMuted, setIsMuted] = useState(false);\n  const [volume, setVolume] = useState(0.3); // 存储原始音量\n  const bgAudioRef = useRef(null);\n  const rollAudioRef = useRef(null);\n  const winAudioRef = useRef(null);\n  const isPlayingEffect = useRef(false);\n  const currentPlayingRef = useRef(null); // 跟踪当前正在播放的音频\n\n  // 设置所有音频的音量\n  const setAllVolumes = vol => {\n    if (bgAudioRef.current) {\n      bgAudioRef.current.volume = vol;\n    }\n    if (rollAudioRef.current) {\n      rollAudioRef.current.volume = vol === 0 ? 0 : 0.7;\n    }\n    if (winAudioRef.current) {\n      winAudioRef.current.volume = vol === 0 ? 0 : 0.8;\n    }\n  };\n  useEffect(() => {\n    // 初始化音频\n    bgAudioRef.current = new Audio(bgMusic);\n    rollAudioRef.current = new Audio(rollMusic);\n    winAudioRef.current = new Audio(winMusic);\n\n    // 设置音频属性\n    if (bgAudioRef.current) {\n      bgAudioRef.current.volume = isMuted ? 0 : volume;\n      bgAudioRef.current.loop = true;\n      // 自动开始播放背景音乐\n      bgAudioRef.current.play().catch(console.error);\n      currentPlayingRef.current = bgAudioRef.current;\n    }\n    if (rollAudioRef.current) {\n      rollAudioRef.current.volume = isMuted ? 0 : 0.7;\n      rollAudioRef.current.loop = true;\n    }\n    if (winAudioRef.current) {\n      winAudioRef.current.volume = isMuted ? 0 : 0.8;\n    }\n\n    // 监听中奖音效结束事件，恢复背景音乐\n    const handleWinEffectEnd = () => {\n      isPlayingEffect.current = false;\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    };\n    winAudioRef.current.addEventListener('ended', handleWinEffectEnd);\n    return () => {\n      if (bgAudioRef.current) {\n        bgAudioRef.current.pause();\n      }\n      if (rollAudioRef.current) {\n        rollAudioRef.current.pause();\n      }\n      if (winAudioRef.current) {\n        winAudioRef.current.pause();\n        winAudioRef.current.removeEventListener('ended', handleWinEffectEnd);\n      }\n    };\n  }, [bgMusic, rollMusic, winMusic, isMuted, volume]);\n  const toggleMute = () => {\n    setIsMuted(!isMuted);\n    // 设置所有音频的音量\n    setAllVolumes(isMuted ? volume : 0);\n  };\n  const playRollMusic = () => {\n    var _bgAudioRef$current, _winAudioRef$current;\n    if (!rollAudioRef.current || isMuted) return;\n    isPlayingEffect.current = true;\n    // 暂停背景音乐\n    (_bgAudioRef$current = bgAudioRef.current) === null || _bgAudioRef$current === void 0 ? void 0 : _bgAudioRef$current.pause();\n    (_winAudioRef$current = winAudioRef.current) === null || _winAudioRef$current === void 0 ? void 0 : _winAudioRef$current.pause();\n\n    // 播放滚动音效\n    rollAudioRef.current.currentTime = 0;\n    rollAudioRef.current.play().catch(error => {\n      console.error('播放滚动音效失败:', error);\n      isPlayingEffect.current = false;\n      // 如果播放失败，尝试恢复背景音乐\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    });\n    currentPlayingRef.current = rollAudioRef.current;\n  };\n  const playWinMusic = () => {\n    var _bgAudioRef$current2, _rollAudioRef$current;\n    if (!winAudioRef.current || isMuted) return;\n    isPlayingEffect.current = true;\n    // 暂停其他音频\n    (_bgAudioRef$current2 = bgAudioRef.current) === null || _bgAudioRef$current2 === void 0 ? void 0 : _bgAudioRef$current2.pause();\n    (_rollAudioRef$current = rollAudioRef.current) === null || _rollAudioRef$current === void 0 ? void 0 : _rollAudioRef$current.pause();\n\n    // 播放中奖音效\n    winAudioRef.current.currentTime = 0;\n    winAudioRef.current.play().catch(error => {\n      console.error('播放中奖音效失败:', error);\n      isPlayingEffect.current = false;\n      // 如果播放失败，尝试恢复背景音乐\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    });\n    currentPlayingRef.current = winAudioRef.current;\n  };\n  return {\n    isMuted,\n    toggleMute,\n    playRollMusic,\n    playWinMusic\n  };\n};\n_s(useAudioControl, \"8t9KOv9nanzyfc22rf1QpTmRmrY=\");","map":{"version":3,"names":["useState","useEffect","useRef","useAudioControl","bgMusic","rollMusic","winMusic","_s","isMuted","setIsMuted","volume","setVolume","bgAudioRef","rollAudioRef","winAudioRef","isPlayingEffect","currentPlayingRef","setAllVolumes","vol","current","Audio","loop","play","catch","console","error","handleWinEffectEnd","addEventListener","pause","removeEventListener","toggleMute","playRollMusic","_bgAudioRef$current","_winAudioRef$current","currentTime","playWinMusic","_bgAudioRef$current2","_rollAudioRef$current"],"sources":["/Users/lingxin/myapp/draw/src/hooks/useAudioControl.js"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\n\nexport const useAudioControl = (bgMusic, rollMusic, winMusic) => {\n  const [isMuted, setIsMuted] = useState(false);\n  const [volume, setVolume] = useState(0.3); // 存储原始音量\n  const bgAudioRef = useRef(null);\n  const rollAudioRef = useRef(null);\n  const winAudioRef = useRef(null);\n  const isPlayingEffect = useRef(false);\n  const currentPlayingRef = useRef(null); // 跟踪当前正在播放的音频\n\n  // 设置所有音频的音量\n  const setAllVolumes = (vol) => {\n    if (bgAudioRef.current) {\n      bgAudioRef.current.volume = vol;\n    }\n    if (rollAudioRef.current) {\n      rollAudioRef.current.volume = vol === 0 ? 0 : 0.7;\n    }\n    if (winAudioRef.current) {\n      winAudioRef.current.volume = vol === 0 ? 0 : 0.8;\n    }\n  };\n\n  useEffect(() => {\n    // 初始化音频\n    bgAudioRef.current = new Audio(bgMusic);\n    rollAudioRef.current = new Audio(rollMusic);\n    winAudioRef.current = new Audio(winMusic);\n\n    // 设置音频属性\n    if (bgAudioRef.current) {\n      bgAudioRef.current.volume = isMuted ? 0 : volume;\n      bgAudioRef.current.loop = true;\n      // 自动开始播放背景音乐\n      bgAudioRef.current.play().catch(console.error);\n      currentPlayingRef.current = bgAudioRef.current;\n    }\n    if (rollAudioRef.current) {\n      rollAudioRef.current.volume = isMuted ? 0 : 0.7;\n      rollAudioRef.current.loop = true;\n    }\n    if (winAudioRef.current) {\n      winAudioRef.current.volume = isMuted ? 0 : 0.8;\n    }\n\n    // 监听中奖音效结束事件，恢复背景音乐\n    const handleWinEffectEnd = () => {\n      isPlayingEffect.current = false;\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    };\n\n    winAudioRef.current.addEventListener('ended', handleWinEffectEnd);\n\n    return () => {\n      if (bgAudioRef.current) {\n        bgAudioRef.current.pause();\n      }\n      if (rollAudioRef.current) {\n        rollAudioRef.current.pause();\n      }\n      if (winAudioRef.current) {\n        winAudioRef.current.pause();\n        winAudioRef.current.removeEventListener('ended', handleWinEffectEnd);\n      }\n    };\n  }, [bgMusic, rollMusic, winMusic, isMuted, volume]);\n\n  const toggleMute = () => {\n    setIsMuted(!isMuted);\n    // 设置所有音频的音量\n    setAllVolumes(isMuted ? volume : 0);\n  };\n\n  const playRollMusic = () => {\n    if (!rollAudioRef.current || isMuted) return;\n\n    isPlayingEffect.current = true;\n    // 暂停背景音乐\n    bgAudioRef.current?.pause();\n    winAudioRef.current?.pause();\n\n    // 播放滚动音效\n    rollAudioRef.current.currentTime = 0;\n    rollAudioRef.current.play().catch(error => {\n      console.error('播放滚动音效失败:', error);\n      isPlayingEffect.current = false;\n      // 如果播放失败，尝试恢复背景音乐\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    });\n    currentPlayingRef.current = rollAudioRef.current;\n  };\n\n  const playWinMusic = () => {\n    if (!winAudioRef.current || isMuted) return;\n\n    isPlayingEffect.current = true;\n    // 暂停其他音频\n    bgAudioRef.current?.pause();\n    rollAudioRef.current?.pause();\n\n    // 播放中奖音效\n    winAudioRef.current.currentTime = 0;\n    winAudioRef.current.play().catch(error => {\n      console.error('播放中奖音效失败:', error);\n      isPlayingEffect.current = false;\n      // 如果播放失败，尝试恢复背景音乐\n      if (!isMuted && bgAudioRef.current) {\n        bgAudioRef.current.play().catch(console.error);\n        currentPlayingRef.current = bgAudioRef.current;\n      }\n    });\n    currentPlayingRef.current = winAudioRef.current;\n  };\n\n  return {\n    isMuted,\n    toggleMute,\n    playRollMusic,\n    playWinMusic\n  };\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}